{{!-- Container for account manipulations --}}
<div class="account_container mt-4">
    <!-- Display approval or disapproval success message -->
    <div class="col-5 mx-auto">
        {{> message}}
    </div>
    <h1>Welcome to your Dashboard, {{usernameOf loggedIn.username}}!</h1>
    {{!-- <div class="row">
        <div class="col">
            <div id="account">
                <img src="https://cdn1.iconfinder.com/data/icons/technology-devices-2/100/Profile-512.png"
                    style="width:90px;height:90px;">
                Edit Your account
            </div>
        </div> --}}
    {{!-- --------------------------------------------------------------------------------- --}}
    <hr style="border: 3px solid rgb(31, 26, 34); max-width: 50%">
    {{!-- --------------------------------------------------------------------------------- --}}
</div>
{{!-- Container for the selling section --}}

<ul class="nav nav-tabs dashboard_tabs">
    <li class="nav-item">
        <a href="#unapproved_tab" class="nav-link active" data-toggle="tab">Unapproved</a>
    </li>
    <li class="nav-item">
        <a href="#approved_tab" class="nav-link" data-toggle="tab">Approved</a>
    </li>
    <li class="nav-item">
        <a href="#messages_tab" class="nav-link" data-toggle="tab">Messages</a>
    </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade show active" id="unapproved_tab">
        <div class="unapproved_container">
            <h2>Items to Approve</h2>
            <ul class="unapproved px-0">
                <li class="table-header">
                    <div class="col col-7">Name</div>
                    <div class="col col-2">Seller</div>
                    <div class="col col-3">
                        Actions
                    </div>
                </li>
                {{#if unapprovedSalesItem}}
                {{#each unapprovedSalesItem}}
                <li class="table-row">
                    <div class="col col-7"><a href="/products/{{this.pid}}">{{this.name}}</a></div>
                    <div class="col col-2">{{usernameOf this.sellerEmail}}</div>
                    <div class="col col-3">
                        <a href="/admin/approve?pid={{this.pid}}"><button type="button" class="btn btn-success btn-sm">Approve</button></a>
                        <!--<a href="/admin/disapprove?pid={{this.pid}}"><button type="button" class="btn btn-danger btn-sm">Disapprove</button></a>-->
                    </div>
                </li>
                {{/each}}
                {{else}}
                <li class="table-row">
                    No listings to review for approval.
                </li>
                {{/if}}
            </ul>
        </div>
    </div>
    <div class="tab-pane fade" id="approved_tab">
        <div class="approved_container">
            <h2>Approved Items </h2>
            <ul class="approved px-0">
                <li class="table-header">
                    <div class="col col-7">Name</div>
                    <div class="col col-2">Seller</div>
                    <div class="col col-3">
                        Actions
                    </div>
                </li>
                {{#if activeSalesItem}}
                {{#each activeSalesItem}}
                <li class="table-row">
                    <div class="col col-7"><a href="/products/{{this.pid}}">{{this.name}}</a></div>
                    <div class="col col-2">{{usernameOf this.sellerEmail}}</div>
                    <div class="col col-3">
                        <!--<a href="#"><button type="button" class="btn btn-warning btn-sm">Block</button></a>-->
                        <a href="/admin/remove?pid={{this.pid}}"><button type="button" class="btn btn-danger btn-sm">Remove</button></a>
                    </div>
                </li>
                {{/each}}
                {{else}}
                <li class="table-row">
                    No active listings.
                </li>
                {{/if}}
            </ul>
        </div>
    </div>
    <div class="tab-pane fade" id="messages_tab">
        {{!-- Container for the messages section --}}
        <div class="admin_messages_container">
            <h2>Your Messages</h2>
            <ul class="admin_messages">
                <table id="myTable">
                    <tr>
                        <th onclick="sortTable(0)">ITEM</th>
                        <th onclick="sortTable(1)">FROM</th>
                        <th onclick="sortTable(2)">SUBJECT</th>
                        <th onclick="sortTable(3)">RECEIVED</th>
                        <th>CHAT</th>
                    </tr>
                    <tr>
                        <td>Chair</td>
                        <td>Jimmy13</td>
                        <td>Pickup</td>
                        <td>Jan 24, 2019</td>
                        <td><button type="button" class="btn btn-primary btn-sm">Open Chat</button></td>
                    </tr>
                    <tr>
                        <td>Book</td>
                        <td>Mario777</td>
                        <td>Discount</td>
                        <td>May 30, 2019</td>
                        <td><button type="button" class="btn btn-primary btn-sm">Open Chat</button></td>
                    </tr>
                    <tr>
                        <td>Chair</td>
                        <td>Alex007</td>
                        <td>Where???</td>
                        <td>Oct 21, 2019</td>
                        <td><button type="button" class="btn btn-primary btn-sm">Open Chat</button></td>
                    </tr>
                    <tr>
                        <td>Zooooooo</td>
                        <td>Kate B</td>
                        <td>WOOOO???</td>
                        <td>Nov 21, 2019</td>
                        <td><button type="button" class="btn btn-primary btn-sm">Open Chat</button></td>
                    </tr>
                </table>     
            </ul>   
        </div>
    </div>
</div>

<script>
    function sortTable(n) {
        var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
        table = document.getElementById("myTable");
        switching = true;
        dir = "asc"; 

        while (switching) {
            switching = false;
            rows = table.rows;

            for (i = 1; i < (rows.length - 1); i++) {
                shouldSwitch = false;

                x = rows[i].getElementsByTagName("TD")[n];
                y = rows[i + 1].getElementsByTagName("TD")[n];

                if (dir == "asc") {
                    if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                        shouldSwitch= true;
                        break;
                    }
                } else if (dir == "desc") {
                    if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                        shouldSwitch = true;
                        break;
                    }
                }
            }
            if (shouldSwitch) {
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
                switchcount ++;      
            } else {
                if (switchcount == 0 && dir == "asc") {
                    dir = "desc";
                    switching = true;
                }
            }
        }
    }
</script>